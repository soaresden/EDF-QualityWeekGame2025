<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.25, viewport-fit=cover, user-scalable=yes">
  <title>Quality Inspector - EDF</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body { font-family: 'Poppins', sans-serif; background: #0a0e27; color: #ccc; overflow: hidden; height: 100vh; touch-action: manipulation; }
    
    canvas { 
      touch-action: none;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }

    .header {
      background: linear-gradient(90deg, #0254A0 0%, #00A8E9 100%);
      color: white;
      padding: 8px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
      border-bottom: 3px solid #00A8E9;
      height: 45px;
    }

    .header-left h1 { font-size: 1.2rem; margin-bottom: 0; }
    .header-right { text-align: right; font-size: 0.85rem; }

    .timer-bar-full {
      background: linear-gradient(90deg, #0254A0 0%, #00A8E9 100%);
      border-bottom: 2px solid #00A8E9;
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
      box-shadow: 0 4px 20px rgba(0, 168, 233, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .windmill {
      font-size: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      min-width: 50px;
    }

    .windmill-blades {
      width: 40px;
      height: 40px;
      animation: windmill-spin 3s linear infinite;
    }

    @keyframes windmill-spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .windmill-wind {
      font-size: 1.2rem;
      animation: wind-wave 0.6s ease-in-out infinite;
    }

    @keyframes wind-wave {
      0%, 100% { opacity: 0.3; transform: translateX(-2px); }
      50% { opacity: 1; transform: translateX(2px); }
    }

    .timer-display { 
      font-size: 2.5rem; 
      font-weight: 900; 
      color: #FFD700;
      min-width: 120px;
      font-family: 'Courier New', monospace;
      letter-spacing: 3px;
      animation: electric-pulse 0.4s ease-in-out infinite;
      filter: drop-shadow(0 0 12px rgba(255, 215, 0, 0.9)) drop-shadow(0 0 6px rgba(255, 215, 0, 0.5));
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
    }

    @keyframes electric-pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .timer-bar { 
      flex: 1;
      height: 22px; 
      background: rgba(0, 0, 0, 0.5); 
      border-radius: 15px; 
      overflow: hidden; 
      border: 2px solid rgba(0, 168, 233, 0.4);
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.6);
      position: relative;
    }

    .timer-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: transparent;
      z-index: 0;
    }

    @keyframes wave-animation {
      0% { background-position: 0 0, 20px 0, 40px 0; }
      100% { background-position: 80px 0, 100px 0, 120px 0; }
    }

    .timer-fill { 
      height: 100%; 
      width: 100%; 
      background: linear-gradient(90deg, #0254A0 0%, #00A8E9 30%, #00D4FF 60%, #0254A0 100%);
      background-size: 200% 100%;
      animation: gradient-flow 3s linear infinite;
      transition: width 0.1s linear;
      box-shadow: 
        0 0 20px rgba(0, 168, 233, 0.8),
        inset 0 1px 2px rgba(255, 255, 255, 0.3),
        inset 0 -1px 2px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      padding: 0 8px;
    }

    .timer-fill::before {
      content: '';
      position: absolute;
      inset: 0;
      background: transparent;
      z-index: 1;
    }

    .wind-effect {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.3);
      font-weight: bold;
      letter-spacing: -2px;
      animation: wind-flow 2s linear infinite;
      white-space: nowrap;
      z-index: 2;
      position: relative;
    }

      100% { transform: translateX(100%); }
    }

    @keyframes gradient-flow {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .timer-fill::after {
      content: '';
      position: absolute;
      right: 0;
      top: 0;
      bottom: 0;
      width: 30px;
      background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.6), rgba(0, 168, 233, 0.3));
      filter: blur(8px);
      animation: edge-glow 1s ease-in-out infinite;
      z-index: 2;
    }

      50% { opacity: 1; }
    }

    .stat-item { text-align: center; }
    .stat-label { font-size: 0.65rem; color: #888; text-transform: uppercase; margin-bottom: 2px; }
    .stat-val { 
      font-size: 1.4rem; 
      font-weight: bold; 
      color: #10B981;
      text-shadow: 0 0 8px rgba(16, 185, 129, 0.5);
    }
    .stat-val.warning { color: #FF5716; text-shadow: 0 0 8px rgba(245, 158, 11, 0.5); }
    .stat-val.danger { color: #EF4444; text-shadow: 0 0 8px rgba(239, 68, 68, 0.5); }

    .main-container {
      display: grid;
      grid-template-columns: 1fr 200px;
      height: calc(100vh - 85px);
      gap: 0;
    }

    .left-panel {
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f2e 100%);
      border-right: 2px solid #10B981;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
      align-items: center;
      justify-content: center;
    }

    .center-area {
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f2e 100%);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      justify-content: flex-start;
      position: relative;
      padding: 15px;
      gap: 8px;
      border-left: 2px solid #00A8E9;
      border-right: 2px solid #10B981;
      height: calc(100vh - 85px);
    }

    .inspection-content {
      display: flex;
      gap: 12px;
      flex: 1;
      min-height: 0;
    }

    .inspection-title {
      font-size: 1.2rem;
      font-weight: 900;
      color: #FFD700;
      text-align: center;
      padding: 6px 12px;
      margin-bottom: 4px;
      letter-spacing: 1px;
      text-transform: uppercase;
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 215, 0, 0.4);
      animation: title-glow 2s ease-in-out infinite;
      background: linear-gradient(90deg, rgba(2, 84, 160, 0.3) 0%, rgba(0, 168, 233, 0.3) 100%);
      border-bottom: 2px solid #FFD700;
      border-radius: 8px 8px 0 0;
    }

    @keyframes title-glow {
      0%, 100% { text-shadow: 0 0 15px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 215, 0, 0.4); }
      50% { text-shadow: 0 0 20px rgba(255, 215, 0, 1), 0 0 40px rgba(255, 215, 0, 0.6); }
    }

    .canvas-container {
      position: relative;
      width: 100%;
      flex: 1;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 4px;
      max-height: calc(100vh - 200px);
      padding: 8px;
      background: rgba(0, 168, 233, 0.05);
      border: 2px solid rgba(0, 168, 233, 0.3);
      border-radius: 8px;
    }

    @keyframes product-transition {
      0% { 
        opacity: 0;
        transform: scale(0.9);
      }
      50% {
        opacity: 0.5;
        transform: scale(1.05);
      }
      100% { 
        opacity: 1;
        transform: scale(1);
      }
    }

    .magnifier-info {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 12px;
      background: rgba(255, 215, 0, 0.1);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 6px;
      margin-bottom: 8px;
      width: 100%;
    }

    .btn {
      padding: 14px 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 900;
      font-size: 0.9rem;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 1;
      min-height: 50px;
    }

    .btn.reject {
      background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
      color: white;
      border: 1px solid #DC2626;
    }

    .btn.reject:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
    }

    .btn.approve {
      background: linear-gradient(135deg, #10B981 0%, #059669 100%);
      color: white;
      border: 1px solid #059669;
    }

    .btn.approve:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }

    .magnifier-circle {
      position: fixed;
      width: 150px;
      height: 150px;
      border: 3px solid #FF5716;
      border-radius: 50%;
      background: transparent;
      pointer-events: none;
      z-index: 100;
      transform: translate(-50%, -50%);
      display: none;
    }

    .magnifier-circle::before {
      content: '';
      position: absolute;
      width: 3px;
      height: 50px;
      background: #FF5716;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .magnifier-circle::after {
      content: '';
      position: absolute;
      width: 50px;
      height: 3px;
      background: #FF5716;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .defect-emoji {
      position: absolute;
      font-size: 1.8rem;
      pointer-events: none;
      animation: popDefect 0.4s ease-out forwards;
      cursor: default;
    }

      100% { transform: scale(1) rotate(360deg); opacity: 1; }
    }

    .status-message {
      font-size: 1.1rem;
      font-weight: bold;
      color: #ccc;
    }

    .status-score {
      font-size: 1.3rem;
      font-weight: bold;
      margin-top: 5px;
    }

    .status-score.good { color: #10B981; }
    .status-score.bad { color: #EF4444; }

    .kpi-section {
      background: rgba(0, 168, 233, 0.2);
      border: 2px solid #00A8E9;
      border-radius: 8px;
      padding: 12px 8px;
      flex: 0 0 auto;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .kpi-section.inspected {
      background: rgba(128, 128, 128, 0.2);
      border-color: #808080;
    }

    .kpi-section.well {
      background: rgba(16, 185, 129, 0.2);
      border-color: #10B981;
    }

    .kpi-section.quality {
      background: rgba(255, 140, 0, 0.2);
      border-color: #FF8C00;
    }

    .kpi-section.quality.high {
      background: rgba(255, 215, 0, 0.2);
      border-color: #FFD700;
    }

    .kpi-section-title {
      font-size: 0.65rem;
      font-weight: 900;
      color: #FFD700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 0;
    }

    .kpi-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 0;
    }

    .kpi-item:last-child {
      margin-bottom: 0;
    }

    .kpi-label {
      font-size: 0.6rem;
      color: #999;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-bottom: 2px;
    }

    .kpi-value {
      font-size: 1.8rem;
      font-weight: 900;
      color: #10B981;
      font-family: 'Courier New', monospace;
      text-shadow: 0 0 10px rgba(16, 185, 129, 0.4);
      line-height: 1;
    }

    .kpi-value.inspected {
      color: #808080;
      text-shadow: 0 0 10px rgba(128, 128, 128, 0.4);
    }

    .kpi-value.well {
      color: #10B981;
      text-shadow: 0 0 10px rgba(16, 185, 129, 0.4);
    }

    .kpi-value.quality {
      color: #FF8C00;
      text-shadow: 0 0 10px rgba(255, 140, 0, 0.4);
    }

    .kpi-value.quality.high {
      color: #FFD700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
    }

    .quality-smiley {
      font-size: 2.5rem;
      text-align: center;
      margin-top: 8px;
      animation: bounce 2s infinite;
    }

    .shewart-chart {
      width: 100%;
      height: 90px;
      background: rgba(0, 0, 0, 0.4);
      border-radius: 6px;
      border: 1px solid #10B981;
      position: relative;
      margin-top: 8px;
    }

    .quit-btn {
      padding: 12px 16px;
      background: linear-gradient(135deg, #6B7280 0%, #4B5563 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 900;
      font-size: 0.85rem;
      transition: all 0.3s;
      margin-top: auto;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .quit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #5a6470 0%, #3a445a 100%);
    }

    .btn { padding: 12px 8px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.85rem; transition: all 0.2s; text-transform: uppercase; }
    .btn.reject { background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%); color: white; border: 1px solid #DC2626; }
    .btn.reject:hover { transform: translateY(-2px); }
    .btn.approve { background: linear-gradient(135deg, #10B981 0%, #059669 100%); color: white; border: 1px solid #059669; }
    .btn.approve:hover { transform: translateY(-2px); }

    .modal h1 { color: #00A8E9; margin-bottom: 20px; font-size: 1.8rem; }
    .modal p { color: #ccc; line-height: 1.6; margin-bottom: 16px; }

    .btn-primary {
      background: linear-gradient(135deg, #00A8E9, #009bcf);
      color: white;
      border: none;
      padding: 14px 32px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1rem;
      width: 100%;
      margin-top: 16px;
      transition: all 0.2s;
    }

    .btn-primary:hover:not(:disabled) { transform: translateY(-2px); }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }

    input {
      width: 100%;
      padding: 12px;
      border: 2px solid #00A8E9;
      background: #0f1419;
      color: white;
      border-radius: 6px;
      font-size: 1rem;
      margin-bottom: 16px;
      font-family: 'Courier New', monospace;
    }

    input:focus { outline: none; box-shadow: 0 0 0 3px rgba(0, 168, 233, 0.3); }

    .rank-timeline {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 8px;
      margin: 30px 0;
      padding: 20px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
    }

    .rank-node {
      padding: 12px;
      border-radius: 6px;
      text-align: center;
      border: 2px solid #333;
      background: rgba(255, 255, 255, 0.05);
    }

    .rank-node.e { border-color: #EF4444; background: rgba(239, 68, 68, 0.1); }
    .rank-node.d { border-color: #00A8E9; background: rgba(0, 168, 233, 0.1); }
    .rank-node.c { border-color: #10B981; background: rgba(16, 185, 129, 0.1); }
    .rank-node.b { border-color: #FF5716; background: rgba(245, 158, 11, 0.1); }
    .rank-node.a { border-color: #FF6B00; background: rgba(255, 107, 0, 0.1); }
    .rank-node.s { border-color: #FFD700; background: rgba(255, 215, 0, 0.1); }

    .rank-node.active {
      box-shadow: 0 0 20px currentColor;
      transform: scale(1.15);
      border-color: currentColor;
    }

    .rank-node.active.e { color: #EF4444; }
    .rank-node.active.d { color: #00A8E9; }
    .rank-node.active.c { color: #10B981; }
    .rank-node.active.b { color: #FF5716; }
    .rank-node.active.a { color: #FF6B00; }
    .rank-node.active.s { color: #FFD700; }

    .rank-letter { font-size: 2rem; font-weight: bold; }
    .rank-name { font-size: 0.7rem; color: #999; margin-top: 4px; }

    .performance-message {
      background: rgba(0, 168, 233, 0.15);
      border: 2px solid #00A8E9;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      font-size: 1.1rem;
      color: #ccc;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .performance-emoji { font-size: 2.5rem; margin-bottom: 10px; }

    .leaderboard-table { width: 100%; margin-top: 20px; border-collapse: collapse; }
    .leaderboard-table th, .leaderboard-table td { padding: 12px; text-align: left; border-bottom: 1px solid #333; color: #ccc; }
    .leaderboard-table th { background: #0254A0; color: white; }
    .leaderboard-table tr:hover { background: rgba(0, 168, 233, 0.1); }

    .leaderboard-container {
      background: rgba(0, 0, 0, 0.3);
      border: 3px solid #FFD700;
      border-radius: 15px;
      padding: 30px;
      max-width: 950px;
      width: 95%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .leaderboard-layout {
      display: grid;
      grid-template-columns: 35% 65%;
      gap: 30px;
      margin-bottom: 20px;
    }

    .leaderboard-left {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .your-score-box {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 168, 233, 0.2));
      border: 3px solid #FFD700;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      width: 100%;
    }

    .score-title {
      color: #FFD700;
      font-size: 0.8rem;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .score-emoji {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .score-text {
      color: #00A8E9;
      font-weight: 900;
      font-size: 1.1rem;
      margin-bottom: 10px;
    }

    .score-value {
      color: #10B981;
      font-weight: 900;
      font-size: 2.5rem;
      text-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
      margin-bottom: 10px;
    }

    .score-ratio {
      color: #FFD700;
      font-weight: 700;
      font-size: 0.95rem;
    }

    .leaderboard-right {
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #00A8E9;
      border-radius: 10px;
      padding: 15px;
      max-height: 500px;
      overflow-y: auto;
    }

    .leaderboard-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .leaderboard-row {
      display: grid;
      grid-template-columns: 50px 1fr 80px 50px;
      gap: 10px;
      padding: 10px;
      background: rgba(0, 168, 233, 0.1);
      border-radius: 6px;
      align-items: center;
      border-left: 3px solid #00A8E9;
      transition: all 0.2s;
    }

    .leaderboard-row:hover {
      background: rgba(0, 168, 233, 0.2);
      border-left-color: #FFD700;
    }

    .leaderboard-row.highlight {
      background: linear-gradient(90deg, rgba(255, 215, 0, 0.3), rgba(0, 168, 233, 0.2));
      border-left-color: #FFD700;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }

    .leaderboard-rank {
      font-weight: 900;
      color: #FFD700;
      font-size: 1.1rem;
      text-align: center;
    }

    .leaderboard-name {
      color: #ccc;
      font-weight: 700;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .leaderboard-score {
      color: #10B981;
      font-weight: 900;
      text-align: right;
    }

    .leaderboard-grade {
      color: #FFD700;
      font-weight: 900;
      text-align: center;
      font-size: 0.9rem;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin: 20px 0;
      background: rgba(0, 168, 233, 0.1);
      padding: 15px;
      border-radius: 8px;
    }

    .stat-box { text-align: center; }
    .stat-box-label { font-size: 0.85rem; color: #999; text-transform: uppercase; margin-bottom: 8px; }
    .stat-box-value { font-size: 1.5rem; font-weight: bold; color: #10B981; }

    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0f1419; }
    ::-webkit-scrollbar-thumb { background: #00A8E9; border-radius: 3px; }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.1); }
      50% { transform: scale(1.2); }
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
    @keyframes slideLeft { from { opacity: 0; transform: translateX(-50px); } to { opacity: 1; transform: translateX(0); } }
    @keyframes slideRight { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }
    50% { box-shadow: 0 15px 60px rgba(255,87,22,0.7); transform: scale(1.05); } }
    @keyframes firework { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; } }
    .firework { position: absolute; width: 10px; height: 10px; border-radius: 50%; pointer-events: none; }

    .overlay-start-inspecting {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.45);
      display: none;
      align-items: flex-end;
      justify-content: center;
      z-index: 200;
      backdrop-filter: blur(3px);
    }

    .overlay-start-inspecting.active {
      display: flex;
    }

    .start-inspecting-content {
      background: linear-gradient(135deg, #0254A0 0%, #1a2f4f 100%);
      border: 3px solid #00A8E9;
      border-radius: 16px 16px 0 0;
      padding: 30px 50px;
      text-align: center;
      box-shadow: 0 0 40px rgba(0, 168, 233, 0.5), inset 0 0 20px rgba(0, 168, 233, 0.2);
      max-width: 95%;
      width: 100%;
      max-height: 40vh;
      animation: slideUp 0.35s cubic-bezier(0.16, 1, 0.3, 1);
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 15px;
    }

    @keyframes slideUp {
      from { 
        transform: translateY(100%); 
        opacity: 0; 
      }
      to { 
        transform: translateY(0); 
        opacity: 1; 
      }
    }

    .start-inspecting-content h2 {
      font-size: 1.5rem;
      color: #00A8E9;
      margin: 0;
      text-shadow: 0 0 10px rgba(0, 168, 233, 0.6);
      font-weight: 700;
    }

    .start-inspecting-content p {
      font-size: 0.95rem;
      color: #ddd;
      margin: 0;
      line-height: 1.5;
      font-weight: 400;
    }

    .start-inspecting-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 10px;
    }

    .start-inspecting-buttons button {
      padding: 12px 35px;
      font-size: 0.95rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .start-inspecting-buttons .btn-yes {
      background: linear-gradient(135deg, #10B981 0%, #059669 100%);
      color: white;
      border: 2px solid #10B981;
    }

    .start-inspecting-buttons .btn-yes:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(16, 185, 129, 0.6);
    }

    .start-inspecting-buttons .btn-no {
      background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
      color: white;
      border: 2px solid #EF4444;
    }

    .start-inspecting-buttons .btn-no:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(239, 68, 68, 0.6);
    }

    .collapsible-header {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s ease;
      padding: 12px;
      font-size: 1.3rem;
      font-weight: 700;
      margin: 0;
      flex-wrap: wrap;
    }

    .collapsible-header:hover { transform: translateX(3px); }

    .chevron {
      font-size: 1.2rem;
      transition: transform 0.3s ease;
      display: inline-block;
    }

    .chevron.collapsed { transform: rotate(-90deg); }

    .collapsible-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, opacity 0.3s ease, padding 0.3s ease;
      opacity: 0;
      margin: 0;
      padding: 0 !important;
    }

    .collapsible-content.collapsed {
      max-height: 0;
      opacity: 0;
      padding: 0 !important;
      overflow: hidden;
    }

    .collapsible-content:not(.collapsed) {
      max-height: 600px;
      opacity: 1;
      padding: 0 12px 12px 12px !important;
      overflow-y: auto;
    }

    #rulesContent:not(.collapsed) {
      max-height: 550px;
    }

    #hallContent:not(.collapsed) {
      max-height: 550px;
    }

    .player-name-box {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
      border: 3px solid white;
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      margin-bottom: 15px;
      animation: slideDown 0.6s ease-out;
    }

    .logo-container {
      text-align: center;
      margin-bottom: 15px;
      animation: fadeInScale 0.8s ease-out;
    }

    .logo-container img {
      height: 60px;
      width: auto;
      object-fit: contain;
      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.2)) drop-shadow(0 0 20px rgba(0, 168, 233, 0.15));
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      transform: scale(1) rotateZ(-1deg);
    }

    .logo-container img:hover {
      transform: scale(1.08) rotateZ(0deg);
      filter: drop-shadow(0 12px 24px rgba(0, 0, 0, 0.3)) drop-shadow(0 0 30px rgba(0, 168, 233, 0.25));
    }

    @keyframes slideDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }

    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .player-name-label {
      font-size: 0.95rem;
      font-weight: bold;
      color: #0254A0;
      margin-bottom: 8px;
      display: block;
    }

    .player-name-input {
      width: 100%;
      padding: 10px 12px !important;
      border: 2px solid #0254A0 !important;
      background: rgba(2, 84, 160, 0.05) !important;
      color: #0254A0 !important;
      font-size: 0.95rem !important;
      margin-bottom: 10px !important;
      font-weight: bold;
      transition: all 0.2s;
    }

    .player-name-input::placeholder { color: rgba(2, 84, 160, 0.6); }
    .player-name-input:focus { 
      outline: none;
      box-shadow: 0 0 0 4px rgba(2, 84, 160, 0.2) !important;
      background: rgba(2, 84, 160, 0.1) !important;
    }

    .validate-btn {
      width: 100%;
      padding: 10px 16px;
      background: linear-gradient(135deg, #FF5716, #E84E0F);
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 900;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .validate-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(255, 87, 22, 0.3); }
    .validate-btn:active { transform: translateY(0); }.history-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border: 2px solid #0254A0;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(2, 84, 160, 0.2);
    }

    .history-table thead {
      background: linear-gradient(90deg, #0254A0 0%, #00A8E9 100%);
      color: white;
    }

    .history-table th {
      padding: 12px 10px;
      font-weight: 900;
      text-align: center;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .history-table td {
      padding: 10px 10px;
      text-align: center;
      border-top: 1px solid #e0e0e0;
      color: #0254A0;
      font-weight: 700;
      font-size: 0.8rem;
      font-family: 'Courier New', monospace;
    }

    .history-table tbody tr:hover {
      background: rgba(0, 168, 233, 0.1);
    }

    .intro-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      width: 100%;
      margin: 0;
      padding: 0 20px;
      box-sizing: border-box;
      height: auto;
      max-height: fit-content;
      align-items: start;
    }

    #rulesContainer,
    #hallofFameContainer {
      display: flex;
      flex-direction: column;
      min-height: auto;
    }

    #rulesContainer .collapsible-content,
    #hallofFameContainer .collapsible-content {
      flex: 1;
    }

    #rulesContainer {
      background: linear-gradient(135deg, rgba(2,84,160,0.95) 0%, rgba(0,168,233,0.85) 100%);
      border-radius: 12px;
      box-shadow: 0 15px 50px rgba(2,84,160,0.4), inset 0 0 30px rgba(255,255,255,0.1);
      animation: slideLeft 0.8s ease-out;
      border: 2px solid rgba(0,168,233,0.8);
      overflow: hidden;
      height: auto;
      align-self: start;
    }

    #rulesContainer .collapsible-header {
      padding: 12px;
      margin: 0;
    }

    #rulesContainer .collapsible-content {
      padding: 0 12px 12px 12px;
    }

    #hallofFameContainer {
      background: linear-gradient(135deg, rgba(255,87,22,0.95) 0%, rgba(255,150,22,0.85) 100%);
      border-radius: 12px;
      box-shadow: 0 15px 50px rgba(255,87,22,0.4), inset 0 0 30px rgba(255,255,255,0.1);
      animation: slideRight 0.8s ease-out;
      border: 2px solid rgba(255,200,100,0.8);
      overflow: hidden;
      height: auto;
      align-self: start;
    }

    #hallofFameContainer .collapsible-header {
      padding: 12px;
      margin: 0;
    }

    #hallofFameContainer .collapsible-content {
      padding: 0 12px 12px 12px;
    }

    @media (max-width: 650px) {
      .intro-content {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

  <!-- END GAME SCREEN -->

  <!-- LEADERBOARD -->
  <div id="leaderboardScreen" class="modal-overlay hidden" style="background: linear-gradient(135deg, #0254A0 0%, #00A8E9 100%); align-items: center; justify-content: center;">
    <div class="leaderboard-container">
      <h1 style="text-align: center; font-size: 2.5rem; font-weight: 900; color: #FFD700; margin-bottom: 30px; text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);">üèÜ LEADERBOARD</h1>
      
      <div class="leaderboard-layout">
        <div class="leaderboard-left">
          <div class="your-score-box">
            <div class="score-title">YOUR PERFORMANCE</div>
            <div class="score-emoji" id="finalEmoji">üéØ</div>
            <div class="score-text" id="finalPlayerText">Amazing!</div>
            <div class="score-value" id="finalPlayerScore">0</div>
            <div class="score-ratio" id="finalPlayerRatio">0/0 = 0%</div>
            <div style="font-size: 0.8rem; color: #00A8E9; margin-top: 8px; font-weight: 700;">QUALITY RATIO</div>
          </div>
        </div>
        
        <div class="leaderboard-right">
          <div class="leaderboard-list" id="leaderboardList">
          </div>
        </div>
      </div>
      
      <button class="btn-primary" style="margin-top: 30px; width: 100%;" onclick="window.showIntroScreenNow()">PLAY AGAIN</button>
    </div>
  </div>

  <!-- INTRO SCREEN -->
  <div id="introScreenAnimated" style="position: fixed; inset: 0; background: linear-gradient(135deg, #0254A0 0%, #00A8E9 100%); display: flex; z-index: 2000; align-items: center; justify-content: flex-start; flex-direction: column; padding: 40px 20px; overflow-y: auto;">
    
    <h1 style="font-size: 2.8rem; font-weight: 900; color: white; text-shadow: 0 0 20px rgba(255,255,255,0.3); margin-bottom: 40px; margin-top: 20px; animation: bounce 2s infinite; cursor: pointer;" id="titleHeart" onclick="window.FIRST_showEasterEgg()">üîç Quality Week 2025 üíó</h1>
    
    <!-- Container principal pour tout aligner proprement -->
    <div style="width: 100%; max-width: 950px; margin-left: auto; margin-right: auto;">
    
    <!-- Layout 2 colonnes : gauche texte, droite input -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px; align-items: start; padding: 0 20px; box-sizing: border-box;">
      
      <!-- LIGNE 1 : LOGOS en haut petits et centr√©s -->
      <div style="display: flex; gap: 20px; width: 100%; margin-bottom: 30px; justify-content: center; align-items: center; flex-wrap: wrap;">
        <!-- Logo COU -->
        <div style="text-align: center;">
          <img src="/img/COU.png" style="max-width: 100px; height: auto;">
        </div>
        <!-- Logo EDFPS -->
        <div style="text-align: center;">
          <img src="/img/EDFPS.jfif" style="max-width: 100px; height: auto;">
        </div>
      </div>
      
      <!-- LIGNE 2 : BLOCS en dessous prenant toute la largeur -->
      <div style="display: flex; gap: 20px; width: 100%; margin-bottom: 30px;">
        
        <!-- GAUCHE : 2 MINUTES GAME -->
        <div style="flex: 1; text-align: left;">
          <div style="background: rgba(0,0,0,0.3); border: 2px solid #FFD700; border-radius: 10px; padding: 15px;">
            <div style="font-size: 0.95rem; font-weight: 700; color: white; margin-bottom: 8px; text-shadow: 0 1px 3px rgba(0,0,0,0.5);">
              ‚è±Ô∏è <span style="color: #FFD700; font-weight: 900;">~2 MINUTES GAME</span>
            </div>
            <div style="font-size: 0.85rem; color: #FFFFFF; line-height: 1.6; font-weight: 600; text-shadow: 0 1px 3px rgba(0,0,0,0.5);">
              You are a <strong>Quality Inspector</strong> for EDF.
              <br/><br/>
              Products will pass in front of you and you must inspect them as <strong>fast AND accurate</strong> as possible.
            </div>
          </div>
        </div>

        <!-- DROITE : Enter Your Name -->
        <div style="flex: 1;">
          <div class="player-name-box" style="width: 100% !important;">
            <label class="player-name-label">üë§ Enter Your Name:</label>
            <div style="position: relative; display: flex; align-items: center;">
              <input type="text" id="playerNameInput" class="player-name-input" placeholder="Type your name..." maxlength="30" onkeypress="if(event.key==='Enter') window.FIRST_validatePlayerName()" style="flex: 1; margin-bottom: 0 !important; padding-right: 35px !important;">
              <button id="clearNameBtn" onclick="window.FIRST_clearPlayerName()" style="position: absolute; right: 8px; background: none; border: none; cursor: pointer; font-size: 1.5rem; color: rgba(2, 84, 160, 0.8); transition: all 0.2s; display: none; padding: 0; width: 30px; height: 30px; line-height: 30px; text-align: center;" title="Clear name">‚úï</button>
            </div>
            <button class="validate-btn" onclick="window.FIRST_validatePlayerName()" style="margin-top: 10px; width: 100%;">‚úì Validate Name</button>
          </div>
        </div>
        
      </div>

    </div>

    <!-- INSPECTION DILEMMA CONDENS√â -->
    <div style="background: rgba(20, 30, 50, 0.8); backdrop-filter: blur(10px); border: 2px solid rgba(0, 168, 233, 0.4); border-radius: 15px; padding: 30px; margin-bottom: 40px; margin-left: 20px; margin-right: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
      
      <div style="text-align: center; margin-bottom: 20px;">
        <div style="font-size: 1.2rem; font-weight: 900; color: #FFD700; letter-spacing: 2px; text-shadow: 0 2px 8px rgba(0,0,0,0.5);">üéØ INSPECTION DILEMMA üéØ</div>
        <div style="font-size: 0.8rem; color: #00A8E9; font-weight: 600; text-shadow: 0 1px 3px rgba(0,0,0,0.5);">Every Quality Inspector faces this fundamental choice...</div>
      </div>
      
      <div style="display: flex; align-items: center; justify-content: center; gap: 20px;">
        
        <!-- OPTION 1: SLOW -->
        <div style="flex: 1; background: linear-gradient(135deg, rgba(16,185,129,0.2) 0%, rgba(16,185,129,0.05) 100%); border: 2px solid #10B981; border-radius: 12px; padding: 18px; text-align: center; box-shadow: 0 6px 15px rgba(16, 185, 129, 0.2);">
          <div style="font-size: 1.8rem; margin-bottom: 10px; animation: bounce 2s infinite;">‚è±Ô∏è</div>
          <div style="font-size: 0.95rem; font-weight: 900; color: #10B981; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">SLOW</div>
          <div style="font-size: 0.75rem; color: #FFFFFF; margin-bottom: 12px; line-height: 1.4;">Take your time</div>
          <div style="background: rgba(16, 185, 129, 0.15); border-left: 3px solid #10B981; padding: 10px; border-radius: 6px; text-align: left; font-size: 0.7rem;">
            <div style="color: #10B981; font-weight: 900; margin-bottom: 5px;">‚úÖ PROS:</div>
            <div style="color: #FFFFFF; margin-bottom: 8px; line-height: 1.3;">‚Ä¢ Catch defects ‚Ä¢ High quality</div>
            <div style="color: #EF4444; font-weight: 900; margin-bottom: 5px;">‚ö†Ô∏è CONS:</div>
            <div style="color: #FFFFFF;">‚Ä¢ Low score</div>
          </div>
        </div>

        <!-- CENTER: VS -->
        <div style="display: flex; flex-direction: column; align-items: center; gap: 5px; font-size: 0.65rem;">
          <div style="font-size: 2.5rem; font-weight: 900; color: #FFD700; animation: pulse 1.5s infinite; text-shadow: 0 2px 8px rgba(255, 215, 0, 0.6);">VS</div>
          <div style="color: #FFD700; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; text-align: center;">Choose</div>
        </div>

        <!-- OPTION 2: FAST -->
        <div style="flex: 1; background: linear-gradient(135deg, rgba(239,68,68,0.2) 0%, rgba(239,68,68,0.05) 100%); border: 2px solid #EF4444; border-radius: 12px; padding: 18px; text-align: center; box-shadow: 0 6px 15px rgba(239, 68, 68, 0.2);">
          <div style="font-size: 1.8rem; margin-bottom: 10px; animation: spin 3s linear infinite;">‚ö°</div>
          <div style="font-size: 0.95rem; font-weight: 900; color: #EF4444; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">FAST</div>
          <div style="font-size: 0.75rem; color: #FFFFFF; margin-bottom: 12px; line-height: 1.4;">Maximize output</div>
          <div style="background: rgba(239, 68, 68, 0.15); border-left: 3px solid #EF4444; padding: 10px; border-radius: 6px; text-align: left; font-size: 0.7rem;">
            <div style="color: #10B981; font-weight: 900; margin-bottom: 5px;">‚úÖ PROS:</div>
            <div style="color: #FFFFFF; margin-bottom: 8px; line-height: 1.3;">‚Ä¢ High score ‚Ä¢ Many products</div>
            <div style="color: #EF4444; font-weight: 900; margin-bottom: 5px;">‚ö†Ô∏è CONS:</div>
            <div style="color: #FFFFFF;">‚Ä¢ Miss defects</div>
          </div>
        </div>

      </div>

    </div>

    <!-- TRADE-OFF et HALL OF FAME c√¥te √† c√¥te -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 40px; padding: 0 20px; box-sizing: border-box;">
      
      <!-- TRADE-OFF √† gauche -->
      <div id="rulesContainer">
        <div class="collapsible-header" onclick="window.FIRST_toggleCollapse('rulesContent')">
          <span class="chevron collapsed" id="rulesChevron">‚ñ∂</span>
          <span style="color: white; font-weight: 900; text-shadow: 0 2px 8px rgba(0,0,0,0.3);" id="rulesTrigger">üìã THE TRADE-OFF</span>
        </div>
        <div id="rulesContent" class="collapsible-content collapsed">
        
        <!-- FIND YOUR BALANCE au dessus -->
        <div style="background: rgba(0,0,0,0.4); border: 2px solid #00A8E9; border-radius: 8px; padding: 15px; margin-bottom: 15px; text-align: center;">
          <div style="font-size: 1rem; font-weight: 900; color: #FFD700; margin-bottom: 8px;">‚öñÔ∏è FIND YOUR BALANCE</div>
          <div style="font-size: 0.8rem; color: #FFFFFF; font-weight: 700; text-shadow: 0 1px 3px rgba(0,0,0,0.5); line-height: 1.6;">
            The challenge is to find the sweet spot between speed and accuracy. Which strategy will you choose?
          </div>
        </div>

        <!-- 2 colonnes avec meilleure explication -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: rgba(0,0,0,0.4); padding: 15px; border-radius: 10px;">
          
          <div style="background: rgba(16,185,129,0.25); border: 2px solid #10B981; border-radius: 8px; padding: 12px;">
            <div style="text-align: center; margin-bottom: 10px;">
              <div style="font-size: 2rem; margin-bottom: 4px;">‚è±Ô∏è üîç</div>
              <div style="font-size: 0.85rem; font-weight: 900; color: #FFD700;">SLOW & CAREFUL</div>
            </div>
            <div style="font-size: 0.75rem; color: #FFFFFF; font-weight: 700; line-height: 1.8; text-shadow: 0 1px 3px rgba(0,0,0,0.5);">
              <div style="margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 8px;">
                <div style="color: #10B981; font-weight: 900;">‚úÖ ADVANTAGES:</div>
                <div>‚Ä¢ Catch defects</div>
                <div>‚Ä¢ High quality</div>
                <div>‚Ä¢ Keep reputation</div>
              </div>
              <div>
                <div style="color: #EF4444; font-weight: 900;">‚ùå DISADVANTAGES:</div>
                <div>‚Ä¢ Fewer inspections</div>
                <div>‚Ä¢ Low Game Score</div>
              </div>
            </div>
          </div>

          <div style="background: rgba(239,68,68,0.25); border: 2px solid #EF4444; border-radius: 8px; padding: 12px;">
            <div style="text-align: center; margin-bottom: 10px;">
              <div style="font-size: 2rem; margin-bottom: 4px;">‚ö° üí®</div>
              <div style="font-size: 0.85rem; font-weight: 900; color: #FFD700;">FAST & CARELESS</div>
            </div>
            <div style="font-size: 0.75rem; color: #FFFFFF; font-weight: 700; line-height: 1.8; text-shadow: 0 1px 3px rgba(0,0,0,0.5);">
              <div style="margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 8px;">
                <div style="color: #10B981; font-weight: 900;">‚úÖ ADVANTAGES:</div>
                <div>‚Ä¢ More inspections</div>
                <div>‚Ä¢ Better Game Score</div>
                <div>‚Ä¢ High throughput</div>
              </div>
              <div>
                <div style="color: #EF4444; font-weight: 900;">‚ùå DISADVANTAGES:</div>
                <div>‚Ä¢ Miss defects</div>
                <div>‚Ä¢ Lost reputation</div>
              </div>
            </div>
          </div>

        </div>
      </div>
      </div>

      <!-- HALL OF FAME √† droite -->
      <div id="hallofFameContainer">
        <div class="collapsible-header" onclick="window.FIRST_toggleCollapse('hallContent')" style="justify-content: space-between;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span class="chevron collapsed" id="hallChevron">‚ñ∂</span>
            <span style="color: white; font-weight: 900; text-shadow: 0 2px 8px rgba(0,0,0,0.3);" id="leaderboardTitle">üèÜ HALL OF FAME</span>
          </div>
          <div id="hallUpdateTime" style="font-size: 0.65rem; color: #FFD700; font-weight: 700; background: rgba(255, 215, 0, 0.12); padding: 5px 12px; border-radius: 20px; border: 1.5px solid rgba(255, 215, 0, 0.3); letter-spacing: 0.3px; display: flex; align-items: center; gap: 6px; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(255, 215, 0, 0.15);">
            <span style="font-size: 0.75rem; display: inline-block; animation: spin 2s linear infinite;">üîÑ</span>
            <span id="updateTimeText" style="font-family: 'Courier New', monospace; white-space: nowrap;">--:--:--</span>
          </div>
        </div>
        <div id="hallContent" class="collapsible-content collapsed">
          <div id="introLeaderboardList" style="display: flex; flex-direction: column; gap: 0; background: transparent; border-radius: 8px; border: none; overflow: hidden; margin-top: 10px; padding-right: 8px;">
            <div style="text-align: center; color: rgba(255,255,255,0.95); font-weight: bold; font-size: 0.95rem;"><p style="margin-bottom: 3px;">‚≠ê No scores yet!</p><p>Be the first!</p></div>
          </div>
        </div>
      </div>

    </div>
    
    <!-- Fin du container principal -->
    </div>

    <div id="historyTableContainer" style="display: none; margin-top: 30px; width: 100%; max-width: 650px; margin-left: auto; margin-right: auto;">
      <div style="color: #00A8E9; font-weight: 900; font-size: 0.9rem; margin-bottom: 10px; text-transform: uppercase;" id="historyTableTitle">üìä Your Previous Games</div>
      <table class="history-table">
        <thead>
          <tr>
            <th style="width: 45%;">Date & Time</th>
            <th style="width: 27%;">Score</th>
            <th style="width: 28%;">Quality</th>
          </tr>
        </thead>
        <tbody id="historyTableBody">
        </tbody>
      </table>
    </div>

    <!-- Historique des games de l'utilisateur -->
    <div id="gameHistoryContainer" style="display: none; margin-top: 30px; width: 90%; max-width: 650px; margin-left: auto; margin-right: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
      <h3 id="gameHistoryTitle" style="color: #0254A0; text-align: center; margin-bottom: 15px; font-size: 1.1rem;">üìä Game History</h3>
      <table style="width: 100%; border-collapse: collapse; background: white;">
        <thead>
          <tr style="background: linear-gradient(90deg, #0254A0 0%, #00A8E9 100%); color: white;">
            <th style="padding: 12px; text-align: left; font-weight: 900;">Date</th>
            <th style="padding: 12px; text-align: center; font-weight: 900;">Score</th>
            <th style="padding: 12px; text-align: center; font-weight: 900;">Rank</th>
          </tr>
        </thead>
        <tbody id="gameHistoryBody" style="color: #333;">
        </tbody>
      </table>
    </div>

    <button id="startGameBtn" onclick="window.FIRST_startGame()" style="margin-top: 20px; padding: 14px 40px; font-size: 1.2rem; font-weight: 900; color: white; background: linear-gradient(135deg, #FF5716 0%, #E84E0F 100%); border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 10px 40px rgba(255,87,22,0.4); animation: pulse 2s infinite; text-transform: uppercase; letter-spacing: 1px; opacity: 0.5; transition: opacity 0.3s;">‚ñ∂ OPEN INSPECTION</button>
  </div>

  <!-- EASTER EGG -->

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = 'https://tqwrsakylbyqmxwyhoar.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxd3JzYWt5bGJ5cW14d3lob2FyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwNjE4NTUsImV4cCI6MjA3NjYzNzg1NX0.WIo5YUtJnxfgsZmnPluGexBAztB7dJG6uYKnNe7o_6A';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let currentLanguage = 'en';
    let gameTimer = null;
    const RANK_MESSAGES = {
      fr: { E: { emoji: 'üòÖ', messages: ['Continue √† pratiquer!'] }, D: { emoji: 'üòê', messages: ['Pas mal!'] }, C: { emoji: 'üëç', messages: ['Pas mal!'] }, B: { emoji: 'üòä', messages: ['Brilliant!'] }, A: { emoji: 'ü§©', messages: ['Awesome!'] }, S: { emoji: 'üëë', messages: ['SPLENDID!'] } },
      en: { E: { emoji: 'üòÖ', messages: ['Keep practicing!'] }, D: { emoji: 'üòê', messages: ['Not bad!'] }, C: { emoji: 'üëç', messages: ['Pretty good!'] }, B: { emoji: 'üòä', messages: ['Brilliant!'] }, A: { emoji: 'ü§©', messages: ['Awesome!'] }, S: { emoji: 'üëë', messages: ['SPLENDID!'] } }
    };

    function formatTimeOnly(date) {
      const hours = String(date.getHours()).padStart(2, '0');
      const mins = String(date.getMinutes()).padStart(2, '0');
      const secs = String(date.getSeconds()).padStart(2, '0');
      return `${hours}:${mins}:${secs}`;
    }

    window.FIRST_toggleCollapse = function(contentId) {
      const content = document.getElementById(contentId);
      const isCollapsed = content.classList.contains('collapsed');
      
      if (contentId === 'rulesContent') {
        const chevron = document.getElementById('rulesChevron');
        content.classList.toggle('collapsed');
        chevron.classList.toggle('collapsed');
      } else if (contentId === 'hallContent') {
        const chevron = document.getElementById('hallChevron');
        content.classList.toggle('collapsed');
        chevron.classList.toggle('collapsed');
      }
    };

    window.FIRST_expandAllSections = function() {
      document.getElementById('rulesContent').classList.remove('collapsed');
      document.getElementById('rulesChevron').classList.remove('collapsed');
      
      document.getElementById('hallContent').classList.remove('collapsed');
      document.getElementById('hallChevron').classList.remove('collapsed');
    };

    window.FIRST_loadGameHistory = async function(username) {
      try {
        const { data, error } = await supabase
          .from('leaderboard')
          .select('*')
          .eq('name', username)
          .order('date', { ascending: false })
          .limit(20);
        
        if (error) throw error;
        
        FIRST_displayGameHistory(username, data || []);
      } catch (err) {FIRST_displayGameHistory(username, []);
      }
    };

    function FIRST_displayGameHistory(username, games) {
      const container = document.getElementById('gameHistoryContainer');
      const tbody = document.getElementById('gameHistoryBody');
      const titleElement = document.getElementById('gameHistoryTitle');
      
      // Mettre le titre avec le pr√©nom color√©
      titleElement.innerHTML = `üìä <span style="color: #00A8E9; font-weight: 900;">${username}</span>'s Game History`;
      
      if (games && games.length > 0) {
        tbody.innerHTML = games.map((game, index) => {
          const date = new Date(game.date || Date.now());
          const day = String(date.getDate()).padStart(2, '0');
          const month = String(date.getMonth() + 1).padStart(2, '0');
          const year = String(date.getFullYear()).slice(-2);
          const hours = String(date.getHours()).padStart(2, '0');
          const mins = String(date.getMinutes()).padStart(2, '0');
          const secs = String(date.getSeconds()).padStart(2, '0');
          
          return `
            <tr style="border-bottom: 1px solid #e0e0e0; background-color: #f9f9f9;">
              <td style="padding: 10px 12px; color: #333;">${day}/${month}/${year} ${hours}:${mins}:${secs}</td>
              <td style="padding: 10px 12px; text-align: center; color: #0254A0; font-weight: 700;">${game.score}</td>
              <td style="padding: 10px 12px; text-align: center; color: #00A8E9; font-weight: 900;">#${index + 1}</td>
            </tr>
          `;
        }).join('');
      } else {
        tbody.innerHTML = '<tr style="border-bottom: 1px solid #e0e0e0;"><td colspan="3" style="padding: 20px; text-align: center; color: #999;">No games yet</td></tr>';
      }
      
      container.style.display = 'block';
    }

    window.FIRST_validatePlayerName = function() {
      const input = document.getElementById('playerNameInput');
      const clearBtn = document.getElementById('clearNameBtn');
      FIRST_playerName = input.value.trim();if (!FIRST_playerName) { 
        alert('Please enter a name!'); 
        return; 
      }
      
      FIRST_playerNameValidated = true;localStorage.setItem('playerName', FIRST_playerName);
      input.disabled = true;
      clearBtn.style.display = 'block';
      clearBtn.onmouseover = function() { this.style.color = 'rgba(2, 84, 160, 1)'; };
      clearBtn.onmouseout = function() { this.style.color = 'rgba(2, 84, 160, 0.6)'; };
      
      // Charger l'historique depuis Supabase
      window.FIRST_loadGameHistory(FIRST_playerName);
      
      const startBtn = document.getElementById('startGameBtn');
      startBtn.disabled = false;
      startBtn.style.opacity = '1';
      startBtn.style.cursor = 'pointer';window.FIRST_expandAllSections();
      
      setTimeout(() => {
        const historyContainer = document.getElementById('gameHistoryContainer');
        if (historyContainer.style.display !== 'none') {
          historyContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }, 100);
    };

    window.FIRST_clearPlayerName = function() {
      const input = document.getElementById('playerNameInput');
      const clearBtn = document.getElementById('clearNameBtn');
      input.value = '';
      input.disabled = false;
      input.focus();
      clearBtn.style.display = 'none';
      FIRST_playerName = '';
      FIRST_playerNameValidated = false;
      
      document.getElementById('startGameBtn').disabled = true;
      document.getElementById('startGameBtn').style.opacity = '0.5';
      
      // Replier les sections
      document.getElementById('rulesContent').classList.add('collapsed');
      document.getElementById('rulesChevron').classList.add('collapsed');
      document.getElementById('hallContent').classList.add('collapsed');
      document.getElementById('hallChevron').classList.add('collapsed');
      
      document.getElementById('historyTableContainer').style.display = 'none';
    };

    window.FIRST_startGame = function() {
      if (!FIRST_playerNameValidated) {
        // Cr√©er un popup styl√©
        const popup = document.createElement('div');
        popup.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: linear-gradient(135deg, #0254A0 0%, #00A8E9 100%);
          border: 3px solid #FFD700;
          border-radius: 15px;
          padding: 30px;
          text-align: center;
          z-index: 10000;
          box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
          min-width: 300px;
          animation: popupIn 0.3s ease-out;
        `;
        popup.innerHTML = `
          <div style="font-size: 2rem; margin-bottom: 15px;">‚ö†Ô∏è</div>
          <div style="color: white; font-size: 1.2rem; font-weight: 900; margin-bottom: 15px;">WAIT!</div>
          <div style="color: #FFD700; font-size: 1rem; font-weight: 700; margin-bottom: 20px;">Please enter your name first!</div>
          <button onclick="this.parentElement.parentElement.remove()" style="padding: 12px 30px; background: #FFD700; color: #0254A0; border: none; border-radius: 8px; font-weight: 900; cursor: pointer; font-size: 1rem;">Got it!</button>
        `;
        
        // Ajouter l'animation au CSS
        if (!document.getElementById('popupInAnimation')) {
          const style = document.createElement('style');
          style.id = 'popupInAnimation';
          style.innerHTML = `
            @keyframes popupIn {
              0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
              100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            }
          `;
          document.head.appendChild(style);
        }
        
        document.body.appendChild(popup);
        return;
      }};

    function FIRST_drawBlade(ctx, x, y) {
      // Turbine blade section
      ctx.fillStyle = '#F5F5F5';
      ctx.beginPath();
      ctx.ellipse(x, y, 50, 90, Math.PI / 6, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.strokeStyle = '#333333';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Surface pattern
      ctx.strokeStyle = '#CCCCCC';
      ctx.lineWidth = 1;
      for (let i = -3; i < 3; i++) {
        ctx.beginPath();
        ctx.moveTo(x + i * 15, y - 90);
        ctx.lineTo(x + i * 15, y + 90);
        ctx.stroke();
      }
      
      // Label
      ctx.fillStyle = '#555555';
      ctx.font = 'bold 12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('BLADE SECTION', x, y + 110);
    }
    
    function FIRST_drawBolt(ctx, x, y) {
      // Large bolt
      const boltSize = 40;
      
      // Bolt head
      ctx.fillStyle = '#C0C0C0';
      ctx.beginPath();
      ctx.arc(x, y - 20, boltSize, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.strokeStyle = '#808080';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Hexagon pattern
      ctx.strokeStyle = '#999999';
      ctx.lineWidth = 1;
      ctx.beginPath();
      for (let i = 0; i < 6; i++) {
        const angle = (i / 6) * Math.PI * 2;
        const px = x + Math.cos(angle) * 25;
        const py = y - 20 + Math.sin(angle) * 25;
        if (i === 0) ctx.moveTo(px, py);
        else ctx.lineTo(px, py);
      }
      ctx.closePath();
      ctx.stroke();
      
      // Bolt shaft
      ctx.fillStyle = '#A9A9A9';
      ctx.fillRect(x - 15, y, 30, 80);
      
      ctx.strokeStyle = '#808080';
      ctx.lineWidth = 1;
      ctx.strokeRect(x - 15, y, 30, 80);
      
      // Threading
      ctx.strokeStyle = '#999999';
      ctx.lineWidth = 1;
      for (let i = 0; i < 5; i++) {
        ctx.beginPath();
        ctx.moveTo(x - 15, y + i * 20);
        ctx.lineTo(x + 15, y + i * 20);
        ctx.stroke();
      }
      
      // Label
      ctx.fillStyle = '#555555';
      ctx.font = 'bold 12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('FOUNDATION BOLT', x, y + 115);
    }
    
    function FIRST_drawCable(ctx, x, y) {
      // Cable connector with multiple pins
      ctx.fillStyle = '#FFD700';
      ctx.beginPath();
      ctx.rect(x - 45, y - 35, 90, 70);
      ctx.fill();
      
      ctx.strokeStyle = '#FF8C00';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Connection points (pins)
      for (let i = 0; i < 4; i++) {
        ctx.fillStyle = '#C0C0C0';
        ctx.beginPath();
        ctx.arc(x - 25 + i * 17, y + 25, 5, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.strokeStyle = '#808080';
        ctx.lineWidth = 1;
        ctx.stroke();
      }
      
      // Cable ports
      ctx.fillStyle = '#444444';
      ctx.fillRect(x - 50, y - 10, 8, 20);
      ctx.fillRect(x + 42, y - 10, 8, 20);
      
      // Label
      ctx.fillStyle = '#555555';
      ctx.font = 'bold 12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('CABLE CONNECTOR', x, y + 60);
    }
    
    function drawTowerSection(ctx, x, y) {
      // Tower section
      ctx.fillStyle = '#E8E8E8';
      ctx.beginPath();
      ctx.rect(x - 40, y - 70, 80, 140);
      ctx.fill();
      
      ctx.strokeStyle = '#333333';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Weld points
      ctx.fillStyle = '#FF6B6B';
      for (let i = 0; i < 3; i++) {
        ctx.beginPath();
        ctx.arc(x - 50, y - 40 + i * 70, 4, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.beginPath();
        ctx.arc(x + 50, y - 40 + i * 70, 4, 0, Math.PI * 2);
        ctx.fill();
      }
      
      // Rust/corrosion spots
      ctx.fillStyle = 'rgba(139, 69, 19, 0.3)';
      for (let i = 0; i < 8; i++) {
        ctx.beginPath();
        ctx.arc(x - 30 + Math.random() * 60, y - 50 + Math.random() * 100, Math.random() * 6 + 2, 0, Math.PI * 2);
        ctx.fill();
      }
      
      // Label
      ctx.fillStyle = '#555555';
      ctx.font = 'bold 12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('TOWER SECTION', x, y + 95);
    }
    
    function FIRST_updateStatus() {
      const status = document.getElementById('productStatus');
      if (!status) return;
      
      if (currentDefects.length === 0) {
        status.textContent = '‚úÖ Equipment is good!';
        status.style.color = '#10B981';
      } else {
        status.textContent = `‚ö†Ô∏è Found ${currentDefects.length - foundDefects.length} defect(s)`;
        status.style.color = '#FF5716';
      }
    }
    
    // G√©rer les clics sur le canvas pour trouver les d√©fauts
    document.addEventListener('DOMContentLoaded', function() {
      const canvas = document.getElementById('productCanvas');
      if (canvas) {
        canvas.addEventListener('click', function(e) {
          if (!gameActive || currentDefects.length === 0) return;
          
          const rect = canvas.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          // V√©rifier si un d√©faut est cliqu√©
          for (let defect of currentDefects) {
            if (!foundDefects.includes(defect)) {
              const dist = Math.sqrt((x - defect.x) ** 2 + (y - defect.y) ** 2);
              if (dist < 15) {
                foundDefects.push(defect);
                FIRST_drawDefect(defect.x, defect.y);
                
                if (foundDefects.length === currentDefects.length) {
                  FIRST_updateStatus();
                }
                return;
              }
            }
          }
        });
      }
    });
    
    function FIRST_drawDefect(x, y) {
      const canvas = document.getElementById('productCanvas');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      // Redessiner le d√©faut en vert (trouv√©)
      ctx.fillStyle = '#10B981';
      ctx.beginPath();
      ctx.arc(x, y, 8, 0, Math.PI * 2);
      ctx.fill();
      
      // Bordure blanche
      ctx.strokeStyle = '#FFFFFF';
      ctx.lineWidth = 2.5;
      ctx.stroke();
      
      // Ajouter une checkmark visible
      ctx.strokeStyle = '#FFFFFF';
      ctx.lineWidth = 2.5;
      ctx.beginPath();
      ctx.moveTo(x - 3, y);
      ctx.lineTo(x, y + 3);
      ctx.lineTo(x + 4, y - 2);
      ctx.stroke();
    }

    window.submitScoreNow = function() {
      const score = {
        name: FIRST_playerName,
        score: gameStats.totalScore,
        good_count: gameStats.productsGood,
        total_count: gameStats.productsInspected,
        quality: gameStats.quality,
        avg_time: (gameStats.productsInspected > 0 ? (gameStats.totalInspectionTime / gameStats.productsInspected).toFixed(1) : 0),
        date: new Date().toISOString()
      };
      
      const local = JSON.parse(localStorage.getItem('leaderboard') || '[]');
      local.push(score);
      local.sort((a, b) => b.score - a.score);
      if (local.length > 100) local.pop();
      localStorage.setItem('leaderboard', JSON.stringify(local));
      
      FIRST_loadLeaderboard();
      FIRST_showLeaderboard();
    };

    function FIRST_showLeaderboard() {
      const local = JSON.parse(localStorage.getItem('leaderboard') || '[]');
      const list = document.getElementById('leaderboardList');
      list.innerHTML = '';
      
      const playerRank = local.findIndex(s => s.name === FIRST_playerName && s.score === gameStats.totalScore) + 1;
      
      document.getElementById('finalEmoji').textContent = RANK_MESSAGES[currentLanguage][gameStats.quality >= 90 ? 'S' : gameStats.quality >= 75 ? 'A' : gameStats.quality >= 60 ? 'B' : gameStats.quality >= 40 ? 'C' : gameStats.quality >= 20 ? 'D' : 'E'].emoji;
      document.getElementById('finalPlayerText').textContent = RANK_MESSAGES[currentLanguage][gameStats.quality >= 90 ? 'S' : gameStats.quality >= 75 ? 'A' : gameStats.quality >= 60 ? 'B' : gameStats.quality >= 40 ? 'C' : gameStats.quality >= 20 ? 'D' : 'E'].messages[0];
      document.getElementById('finalPlayerScore').textContent = gameStats.totalScore;
      document.getElementById('finalPlayerRatio').textContent = `${gameStats.productsGood}/${gameStats.productsInspected} = ${gameStats.quality}%`;
      
      local.slice(0, 20).forEach((s, i) => {
        const grade = s.quality >= 90 ? 'S' : s.quality >= 75 ? 'A' : s.quality >= 60 ? 'B' : s.quality >= 40 ? 'C' : s.quality >= 20 ? 'D' : 'E';
        const isCurrentPlayer = s.name === FIRST_playerName && s.score === gameStats.totalScore;
        const row = document.createElement('div');
        row.className = 'leaderboard-row' + (isCurrentPlayer ? ' highlight' : '');
        row.innerHTML = `
          <div class="leaderboard-rank">#${i+1}</div>
          <div class="leaderboard-name">${s.name}</div>
          <div class="leaderboard-score">${s.score}</div>
          <div class="leaderboard-grade">${grade}</div>
        `;
        list.appendChild(row);
      });
      
      const end = document.getElementById('endGameScreen');
      const board = document.getElementById('leaderboardScreen');
      if (end) end.classList.add('hidden');
      if (board) board.classList.remove('hidden');
    }

    window.showIntroScreenNow = function() {
      const intro = document.getElementById('introScreenAnimated');
      const board = document.getElementById('leaderboardScreen');
      
      FIRST_playerNameValidated = false;
      document.getElementById('playerNameInput').disabled = false;
      document.getElementById('playerNameInput').value = '';
      document.getElementById('clearNameBtn').style.display = 'none';
      document.getElementById('gameNumberBox').style.display = 'none';
      document.getElementById('startGameBtn').disabled = true;
      document.getElementById('startGameBtn').style.opacity = '0.5';
      
      // Bien replier les sections
      document.getElementById('rulesContent').classList.add('collapsed');
      document.getElementById('rulesChevron').classList.add('collapsed');
      document.getElementById('hallContent').classList.add('collapsed');
      document.getElementById('hallChevron').classList.add('collapsed');
      
      document.getElementById('historyTableContainer').style.display = 'none';
      
      if (intro) intro.style.display = 'flex';
      if (board) board.classList.add('hidden');
    };

    window.FIRST_showEasterEgg = function() {
      const overlay = document.getElementById('easterOverlay');
      if (overlay) {
        overlay.style.display = 'flex';
        FIRST_createFireworks();
        setTimeout(() => { overlay.style.display = 'none'; }, 5000);
      }
    };

    function FIRST_createFireworks() {
      const container = document.getElementById('fireworksContainer');
      if (!container) return;
      container.innerHTML = '';
      const colors = ['#FF5716', '#FFD700', '#00A8E9'];
      for (let i = 0; i < 80; i++) {
        setTimeout(() => {
          const fw = document.createElement('div');
          fw.className = 'firework';
          fw.style.background = colors[Math.floor(Math.random() * colors.length)];
          fw.style.left = (50 + Math.cos((Math.PI * 2 * i) / 80) * 30) + '%';
          fw.style.top = (50 + Math.sin((Math.PI * 2 * i) / 80) * 30) + '%';
          fw.style.setProperty('--tx', Math.cos((Math.PI * 2 * i) / 80) * 150 + 'px');
          fw.style.setProperty('--ty', Math.sin((Math.PI * 2 * i) / 80) * 150 + 'px');
          fw.style.animation = `firework ${1.2 + Math.random() * 0.6}s ease-out forwards`;
          container.appendChild(fw);
        }, i * 20);
      }
    }

    window.quitGameNow = function() {
      gameActive = false;
      if (gameTimer) clearInterval(gameTimer);
      
      gameStats.quality = gameStats.productsInspected > 0 ? Math.round((gameStats.productsGood / gameStats.productsInspected) * 100) : 0;
      const rank = gameStats.quality >= 90 ? 'S' : gameStats.quality >= 75 ? 'A' : gameStats.quality >= 60 ? 'B' : gameStats.quality >= 40 ? 'C' : gameStats.quality >= 20 ? 'D' : 'E';
      
      document.querySelectorAll('.rank-node').forEach(n => n.classList.remove('active'));
      const nodeEl = document.querySelector(`.rank-node.${rank}`);
      if (nodeEl) nodeEl.classList.add('active');

      document.getElementById('performanceEmoji').textContent = RANK_MESSAGES[currentLanguage][rank].emoji;
      document.getElementById('performanceText').innerHTML = `<strong style="font-size: 1.3rem; color: #00A8E9;">${RANK_MESSAGES[currentLanguage][rank].messages[0]}</strong>`;
      document.getElementById('finalRatio').textContent = `${gameStats.productsGood}/${gameStats.productsInspected} = ${gameStats.quality}%`;
      document.getElementById('finalScore').textContent = gameStats.totalScore;
      document.getElementById('maxComboDisplay').textContent = gameStats.maxCombo;
      document.getElementById('avgTime').textContent = (gameStats.productsInspected > 0 ? (gameStats.totalInspectionTime / gameStats.productsInspected).toFixed(1) : 0) + 's';

      const gameScreen = document.getElementById('gameScreen');
      const endScreen = document.getElementById('endGameScreen');
      if (gameScreen) gameScreen.classList.add('hidden');
      if (endScreen) endScreen.classList.remove('hidden');
    };

    async function FIRST_loadLeaderboard() {
      FIRST_loadLeaderboardFallback();
    }

     function FIRST_loadLeaderboardFallback() {
      const local = JSON.parse(localStorage.getItem('leaderboard') || '[]');
      FIRST_displayLeaderboard(local.slice(0, 20));
      FIRST_updateTimestamp(false);
    }

    function FIRST_updateTimestamp(isCloud) {
      const date = new Date();
      const day = String(date.getDate()).padStart(2, '0');
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const year = String(date.getFullYear()).slice(-2);
      const hours = String(date.getHours()).padStart(2, '0');
      const mins = String(date.getMinutes()).padStart(2, '0');
      const secs = String(date.getSeconds()).padStart(2, '0');
      
      const icon = isCloud ? '‚òÅÔ∏è' : 'üè†';
      document.getElementById('updateTimeText').textContent = `${icon} Updated ${day}/${month}/${year} ${hours}:${mins}:${secs}`;
    }

    function FIRST_displayLeaderboard(scores) {
      const introList = document.getElementById('introLeaderboardList');
      introList.innerHTML = '';
      
      if (!scores || scores.length === 0) {
        introList.innerHTML = '<div style="text-align: center; color: rgba(255,255,255,0.95); font-weight: bold; font-size: 0.95rem;"><p style="margin-bottom: 3px;">‚≠ê No scores yet!</p><p>Be the first!</p></div>';
        return;
      }
      
      scores.slice(0, 15).forEach((s, i) => {
        const grade = s.quality >= 90 ? 'S' : s.quality >= 75 ? 'A' : s.quality >= 60 ? 'B' : s.quality >= 40 ? 'C' : s.quality >= 20 ? 'D' : 'E';
        const medals = { 1: 'ü•á', 2: 'ü•à', 3: 'ü•â' };
        const medal = medals[i + 1] || 'üéñÔ∏è';
        
        // Couleurs du grade - align√©es avec le leaderboard final
        const gradeColors = {
          'S': '#FFD700',
          'A': '#FF6B00',
          'B': '#FF5716',
          'C': '#10B981',
          'D': '#00A8E9',
          'E': '#EF4444'
        };
        const gradeColor = gradeColors[grade] || '#FFD700';
        
        // Couleurs √©clatantes par rang
        const rankColors = {
          1: { bg: '#FFD700', glow: 'rgba(255, 215, 0, 0.6)', textLight: '#000' },
          2: { bg: '#E8E8E8', glow: 'rgba(232, 232, 232, 0.6)', textLight: '#000' },
          3: { bg: '#FF8C00', glow: 'rgba(255, 140, 0, 0.6)', textLight: '#fff' }
        };
        const defaultColor = { bg: 'rgba(0, 168, 233, 0.7)', glow: 'rgba(0, 168, 233, 0.4)', textLight: '#fff' };
        const colors = rankColors[i + 1] || defaultColor;
        
        const date = new Date(s.date || Date.now());
        const day = String(date.getDate()).padStart(2, '0');
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const year = String(date.getFullYear()).slice(-2);
        const hours = String(date.getHours()).padStart(2, '0');
        const mins = String(date.getMinutes()).padStart(2, '0');
        
        const row = document.createElement('div');
        row.style.cssText = `
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 10px 12px;
          background: ${i + 1 <= 3 ? colors.bg : 'rgba(20, 30, 50, 0.8)'};
          border: 2px solid ${i + 1 <= 3 ? colors.bg : 'rgba(0, 168, 233, 0.5)'};
          border-radius: 8px;
          margin-bottom: 6px;
          transition: all 0.25s;
          box-shadow: ${i + 1 <= 3 ? `0 0 15px ${colors.glow}` : '0 2px 6px rgba(0, 0, 0, 0.4)'};
        `;
        row.onmouseover = function() { 
          this.style.transform = 'translateX(8px) scale(1.02)';
          this.style.boxShadow = i + 1 <= 3 
            ? `0 0 25px ${colors.glow}, 0 8px 16px rgba(0, 0, 0, 0.4)` 
            : '0 4px 12px rgba(0, 168, 233, 0.5)';
        };
        row.onmouseout = function() { 
          this.style.transform = 'translateX(0) scale(1)';
          this.style.boxShadow = i + 1 <= 3 
            ? `0 0 15px ${colors.glow}` 
            : '0 2px 6px rgba(0, 0, 0, 0.4)';
        };
        
        row.innerHTML = `
          <div style="display: flex; align-items: center; gap: 6px; min-width: 50px; flex-shrink: 0;">
            <div style="color: ${i + 1 <= 3 ? colors.textLight : '#FFD700'}; font-weight: 900; font-size: 0.9rem;">#${i+1}</div>
            <div style="font-size: 1.8rem;">${medal}</div>
          </div>
          
          <div style="flex: 1; min-width: 0; overflow: hidden;">
            <div style="color: ${i + 1 <= 3 ? colors.textLight : '#FFFFFF'}; font-weight: 900; font-size: 1rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; ${i + 1 <= 3 ? 'text-shadow: 0 1px 2px rgba(0,0,0,0.3)' : ''};">${s.name}</div>
            <div style="color: ${i + 1 <= 3 ? colors.textLight : '#00A8E9'}; font-weight: 600; font-size: 0.7rem; opacity: ${i + 1 <= 3 ? '0.8' : '0.9'};">${day}/${month}/${year} ${hours}:${mins}</div>
          </div>
          
          <div style="text-align: right; min-width: 70px; flex-shrink: 0;">
            <div style="color: ${i + 1 <= 3 ? colors.textLight : '#10B981'}; font-weight: 900; font-size: 1.15rem; ${i + 1 <= 3 ? 'text-shadow: 0 1px 2px rgba(0,0,0,0.3)' : 'text-shadow: 0 1px 3px rgba(0,0,0,0.5)'};">${s.score}</div>
            <div style="color: ${gradeColor}; font-weight: 900; font-size: 0.85rem; opacity: 1;">${grade}</div>
          </div>
        `;
        introList.appendChild(row);
      });
    }

    window.addEventListener('load', () => {
      const saved = localStorage.getItem('playerName');
      if (saved) document.getElementById('playerNameInput').value = saved;
      
      FIRST_loadLeaderboard();
    });
  </script>

  <!-- Easter Egg Overlay -->
  <div id="easterOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, rgba(2, 84, 160, 0.95) 0%, rgba(0, 168, 233, 0.95) 100%); z-index: 9999; align-items: center; justify-content: center; flex-direction: column;">
    <div style="display: flex; align-items: center; gap: 40px; max-width: 950px;">
      <div style="position: relative; padding: 8px; background: linear-gradient(135deg, #FFD700 0%, #FF6B00 50%, #FFD700 100%); border-radius: 16px; box-shadow: 0 0 30px rgba(255, 107, 0, 0.8), inset 0 0 20px rgba(255, 215, 0, 0.3);">
        <img src="/img/qualiteam.jpg">
      </div>
      <div style="text-align: center; color: white;">
        <h2 style="font-size: 2.5rem; font-weight: 900; margin-bottom: 15px; text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3); animation: pulse 0.8s infinite;">Made with Love üíó</h2>
        <p style="font-size: 1.8rem; font-weight: 700; letter-spacing: 2px; text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);">QualiTeam üíó</p>
      </div>
    </div>
    <div id="fireworksContainer" style="position: absolute; width: 100%; height: 100%; pointer-events: none;"></div>
  </div>

  <div id="overlayStartInspecting" class="overlay-start-inspecting">
    <div class="start-inspecting-content">
      <h2>üîç READY TO START INSPECTING?</h2>
      <p>You are now <strong>Quality Inspector for EDF</strong>. You have <strong>5 minutes</strong> to inspect products and maintain quality!</p>
      <div class="start-inspecting-buttons">
        <button class="btn-yes" onclick="alert('GO TO SCREEN2');">YES, LET'S GO! ‚ñ∂</button>
        <button class="btn-no" onclick="window.cancelStartGame()">WAIT, I NEED HELP</button>
      </div>
    </div>
  </div>

  <script>

  </script>

</body>
</html>