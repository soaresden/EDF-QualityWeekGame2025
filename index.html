<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Jeu pédagogique: Contrôle Qualité Systèmes Éoliens Marins">
  <meta name="theme-color" content="#09367A">
  
  <title>🔍 Quality Control - Offshore Wind Game</title>
  
  <!-- Styles -->
  <link rel="stylesheet" href="./css/main.css">
  <link rel="stylesheet" href="./css/animations.css">
</head>
<body>
  <!-- Conteneur principal -->
  <div class="game-container">
    <div id="gameRoot"></div>
  </div>

  <!-- Popup feedback (non-bloquant) -->
  <div id="popupFeedback" class="popup-feedback" style="display: none;"></div>

  <!-- ÉCRAN SÉLECTION LANGUE -->
  <div id="languageScreen" class="modal-overlay">
    <div class="modal" style="max-width: 400px;">
      <h1 id="langTitle">🌐 LANGUAGE</h1>
      <p id="langSubtitle" style="margin-bottom: 32px;">Select your language</p>
      <div class="lang-selector">
        <div class="lang-button" onclick="setLanguage('fr')">🇫🇷<br><strong>Français</strong></div>
        <div class="lang-button" onclick="setLanguage('en')">🇬🇧<br><strong>English</strong></div>
      </div>
    </div>
  </div>

  <!-- ÉCRAN NOM DU JOUEUR -->
  <div id="playerNameScreen" class="modal-overlay hidden">
    <div class="modal" style="max-width: 500px;">
      <h1 id="nameTitle">👤 Your Name</h1>
      <p id="nameSubtitle" style="margin-bottom: 20px;">Enter your name for the leaderboard:</p>
      <input type="text" id="playerNameInput" class="input-field" maxlength="30" placeholder="Your name">
      <button class="button-primary" onclick="confirmPlayerName()">START GAME →</button>
    </div>
  </div>

  <!-- ÉCRAN INTRO -->
  <div id="introScreen" class="modal-overlay hidden">
    <div class="modal" style="max-width: 800px;">
      <h1 id="introTitle">🔍 QUALITY CONTROL</h1>
      <h2 id="introSubtitle">Offshore Wind Systems</h2>
      
      <p id="introObjective" style="margin-top: 24px;"><strong>🎯 Goal:</strong></p>
      
      <div class="rules" style="margin-bottom: 24px;">
        <p id="rule1">🔍 Find defects with the TINY magnifier</p>
        <p id="rule2">⏱️ Stay 3+ seconds on a defect to reveal it</p>
        <p id="rule3">✓ Validate your inspection (good/reject/doubtful)</p>
        <p id="rule4">💰 Reach 2000€/day to progress</p>
        <p id="rule5" style="margin-bottom: 0;">🚀 Each day: more defects, less time!</p>
      </div>

      <table class="defect-table">
        <thead>
          <tr>
            <th>⚠️ MINOR</th>
            <th>⚠️ MEDIUM</th>
            <th>❌ MAJOR</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <span class="severity-badge severity-low">Scratch</span><br>
              <span class="severity-badge severity-low">Minor wear</span>
            </td>
            <td>
              <span class="severity-badge severity-medium">Crack</span><br>
              <span class="severity-badge severity-medium">Misalignment</span>
            </td>
            <td>
              <span class="severity-badge severity-high">Corrosion</span><br>
              <span class="severity-badge severity-high">Leak</span>
            </td>
          </tr>
        </tbody>
      </table>

      <button class="button-primary" onclick="startGameplay()">I UNDERSTAND →</button>
    </div>
  </div>

  <!-- ÉCRAN JEU PRINCIPAL -->
  <div id="gameScreen" class="modal-overlay hidden">
    <div class="modal" style="width: 95vw; max-width: 1000px; height: 90vh; display: flex; flex-direction: column;">
      
      <!-- En-tête du jeu -->
      <div class="screen-header" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px;">
        <div>
          <div class="stat-label">Day</div>
          <div class="stat-value" id="dayDisplay">1</div>
        </div>
        <div>
          <div class="stat-label">Time Left</div>
          <div class="stat-value" id="timeDisplay">8h 00m</div>
        </div>
        <div>
          <div class="stat-label">Money</div>
          <div class="stat-value" style="color: #10B981;" id="moneyDisplay">2500€</div>
        </div>
        <div>
          <div class="stat-label">Quota Target</div>
          <div class="stat-value" style="color: #00A8E9;" id="quotaDisplay">2000€</div>
        </div>
      </div>

      <!-- Zone de jeu (produits) -->
      <div id="gameArea" style="flex: 1; overflow-y: auto; padding: 16px; background: #f9fafb; border-radius: 12px; margin-bottom: 24px;">
        <div id="productContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 16px;">
          <!-- Les produits seront générés ici -->
        </div>
      </div>

      <!-- Panneau d'inspection (produit courant) -->
      <div id="inspectionPanel" style="background: white; border: 2px solid #00A8E9; border-radius: 12px; padding: 16px; display: none;">
        <h3 id="currentProductName">Produit</h3>
        <p id="defectStatus">Défauts: 0</p>
        <div id="decisionButtons" style="display: flex; gap: 12px; margin-top: 16px;">
          <button class="decision-btn good" onclick="makeDecision('good')">✓ GOOD</button>
          <button class="decision-btn reject" onclick="makeDecision('reject')">✗ REJECT</button>
          <button class="decision-btn doubt" onclick="makeDecision('doubt')">? DOUBTFUL</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ÉCRAN FIN DE JOURNÉE -->
  <div id="dayEndScreen" class="modal-overlay hidden">
    <div class="modal" style="max-width: 600px;">
      <h1 id="dayEndTitle">📊 END OF DAY</h1>
      
      <div class="stats-grid" style="margin-bottom: 32px;">
        <div class="stat-card">
          <div class="stat-label">Revenue</div>
          <div class="stat-value" id="dayRevenue">0€</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Salary</div>
          <div class="stat-value">150€</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Charges</div>
          <div class="stat-value">-400€</div>
        </div>
        <div class="stat-card">
          <div class="stat-label" style="color: #10B981;">Day Balance</div>
          <div class="stat-value" style="color: #10B981;" id="dayBalance">0€</div>
        </div>
      </div>

      <div class="stats-grid" style="margin-bottom: 32px;">
        <div class="stat-card">
          <div class="stat-label">Accuracy</div>
          <div class="stat-value" id="accuracyDisplay">0%</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Accepted</div>
          <div class="stat-value" id="acceptedDisplay">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Rejected</div>
          <div class="stat-value" id="rejectedDisplay">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label" style="color: #09367A;">Total Balance</div>
          <div class="stat-value" style="color: #09367A;" id="totalBalance">0€</div>
        </div>
      </div>

      <!-- Upgrades Section -->
      <h3 style="margin-bottom: 20px;">🛠️ UPGRADES</h3>
      <div id="upgradesContainer" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px;">
        <!-- Upgrades seront générés ici -->
      </div>

      <button class="button-primary" onclick="nextDay()">NEXT DAY →</button>
    </div>
  </div>

  <!-- ÉCRAN VICTOIRE / FAILLITE -->
  <div id="gameOverScreen" class="modal-overlay hidden">
    <div class="modal" style="max-width: 500px; text-align: center;">
      <h1 id="gameOverTitle">💸 BANKRUPT!</h1>
      <p id="gameOverSubtitle" style="font-size: 1.1rem; margin-bottom: 32px;">You didn't have enough...</p>
      
      <div class="card highlight" style="margin-bottom: 32px;">
        <div class="stat-label">Final Balance</div>
        <div class="stat-value" id="finalBalance">0€</div>
      </div>

      <div id="leaderboardDisplay" style="margin-bottom: 32px;"></div>

      <button class="button-primary" onclick="location.reload()">RESTART</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="./js/i18n.js"></script>
  <script src="./js/game.js"></script>
  <script src="./js/ui.js"></script>
  <script src="./js/app.js"></script>
</body>
</html>
